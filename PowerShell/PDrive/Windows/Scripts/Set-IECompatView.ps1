Write-Output 'Creating HKU drive...'
New-PSDrive -Name HKU -PSProvider Registry -Root Registry::HKEY_USERS -ErrorAction SilentlyContinue | Out-Null

Write-Output 'Parsing User SIDs...'
$UserSids = (Get-ChildItem HKU: | where { $_.Name -match 'S-\d-\d+-(\d+-){1,14}\d+$' }).PSChildName

foreach ($SID in $UserSids) {
    Write-Output "Updating SID: $($SID)"
    if (test-path "HKU:\$SID\Software\Microsoft\Internet Explorer\BrowserEmulation\ClearableListData") {
        Write-Output 'ClearableListData found!'
        Set-ItemProperty -Path "HKU:\$SID\Software\Microsoft\Internet Explorer\BrowserEmulation\ClearableListData" -Type Binary -Name UserFilter -Value ([byte[]](0x41,0x1f,0x00,0x00,0x53,0x08,0xad,0xba,0x01,0x00,0x00,0x00,0x32,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x0c,0x00,0x00,0x00,0x0a,0xdf,0xe7,0xb9,0xc3,0x3d,0xd1,0x01,0x01,0x00,0x00,0x00,0x0a,0x00,0x68,0x00,0x75,0x00,0x6d,0x00,0x61,0x00,0x6e,0x00,0x61,0x00,0x2e,0x00,0x63,0x00,0x6f,0x00,0x6d,0x00)) -Force | Out-Null
        Write-Output 'Set Compat View to humana.com!'
    } else {
        Write-Output 'ClearableListData not found!'
        New-Item -Path "HKU:\$SID\Software\Microsoft\Internet Explorer\BrowserEmulation\" -ErrorAction SilentlyContinue | Out-Null
        New-Item -Path "HKU:\$SID\Software\Microsoft\Internet Explorer\BrowserEmulation\ClearableListData\" -ErrorAction SilentlyContinue | Out-Null
        New-ItemProperty -Path "HKU:\$SID\Software\Microsoft\Internet Explorer\BrowserEmulation\ClearableListData" -Type Binary -Name UserFilter -Value ([byte[]](0x41,0x1f,0x00,0x00,0x53,0x08,0xad,0xba,0x01,0x00,0x00,0x00,0x32,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x0c,0x00,0x00,0x00,0x0a,0xdf,0xe7,0xb9,0xc3,0x3d,0xd1,0x01,0x01,0x00,0x00,0x00,0x0a,0x00,0x68,0x00,0x75,0x00,0x6d,0x00,0x61,0x00,0x6e,0x00,0x61,0x00,0x2e,0x00,0x63,0x00,0x6f,0x00,0x6d,0x00)) -Force | Out-Null
        Write-Output 'Added humana.com to Compat View!'
    }
}