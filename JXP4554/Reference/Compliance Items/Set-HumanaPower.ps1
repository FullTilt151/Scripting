# Set this variable to true for the remediation script, false for the detection script
$remediate = $false
$PowerText = 'cmVnZgEAAAABAAAAwTJErJGm0wEBAAAAAwAAAAAAAAABAAAAIAAAAAAQAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAImK10CkEegRqNtU4a0FhY6JitdApBHoEajbVOGtBYWOAAAAAIqK10CkEegRqNtU4a0FhY5ybXRtAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFnJapgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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HAAAAAQAAAAAAAAAJAAAADY3MzhlMmM0LWU4YTUtNGE0Mi1iMTZhLWUwNDBlNzY5NzU2ZQEBAADY////dmsOAAQAAIAAAAAABAAAAAEAVWNBQ1NldHRpbmdJbmRleOxO8P///1AFAACIBQAAAAAAANj///92aw4ABAAAgAgHAAAEAAAAAQBkAERDU2V0dGluZ0luZGV4AADw////bGYBANgEAAA2NzM4iP///25rIACDvrJzR5zTAQAAAAAgAAAAAQAAAAAAAADwBgAA/////wAAAAD/////4AMAAP////9IAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAxOWNiYjhmYS01Mjc5LTQ1MGUtOWZhYy04YTNkNWZlZGQwYzGvQD0q8P///2xmAQCgBwAAOWQ3OPj///94BwAAiP///25rIACDvrJzR5zTAQAAAADABQAAAAAAAAAAAAD//////////wEAAADIBAAA4AMAAP////8AAAAAAAAAABwAAAAEAAAAAAAAACQAAAAxMmJiZWJlNi01OGQ2LTQ2MzYtOTViYi0zMjE3ZWY4NjdjMWGdBCEd2P///3ZrDgAEAACAAQAAAAMAAAABAAAARENTZXR0aW5nSW5kZXgAAPD///9sZgEAUAYAADEyYmKI////bmsgAFwAFOBJnNMBAAAAACAAAAABAAAAAAAAADgGAAD/////AAAAAP/////gAwAA/////0gAAAAAAAAAAAAAAAAAAAABAAAAJAAAADIzOGM5ZmE4LTBhYWQtNDFlZC04M2Y0LTk3YmUyNDJjOGYyMAAAAADY////dmsOAAQAAIBLAAAABAAAAAEAAABEQ1NldHRpbmdJbmRleAAAiP///25rIABcABTgSZzTAQAAAAAABwAAAAAAAAAAAAD//////////wEAAADQBAAA4AMAAP////8AAAAAAAAAABwAAAAEAAAAAAAAACQAAAA5ZDc4MTVhNi03ZWU0LTQ5N2UtODg4OC01MTVhMDVmMDIzNjQAAAAA2P///3ZrDgAEAACAAAAAAAQAAAABAAAAQUNTZXR0aW5nSW5kZXgAAIj///9uayAASkas+Fff0QEAAAAAIAAAAAAAAAAAAAAA//////////8CAAAA4AgAAJgAAAD/////AAAAAAAAAAAcAAAABAAAAAIAAAAkAAAAMjQ1ZDg1NDEtMzk0My00NDIyLWIwMjUtMTNhNzg0ZjY3OWI3AAAAANj///92aw4ABAAAgAIAAAAEAAAAAQAAAEFDU2V0dGluZ0luZGV4AADw////uAgAAPAIAAAAAAAA2P///3ZrDgAEAACAAgAAAAQAAAABAAAARENTZXR0aW5nSW5kZXgYAIj///9uayAAR0IrqEec0wEAAAAAIAAAAAEAAAAAAAAASAoAAP////8AAAAA/////+ADAAD/////SAAAAAAAAAAAAAAAAAAAAAMAAAAkAAAANTQ1MzMyNTEtODJiZS00ODI0LTk2YzEtNDdiNjBiNzQwZDAwAAAAAMD///9sZgcAaAMAADAwMTLABQAAMTljYgAHAAAyMzhjQAgAADI0NWQYCQAANTQ1M1gKAAA3NTE2SAwAADk1OTaI////bmsgAEdCK6hHnNMBAAAAABgJAAAAAAAAAAAAAP//////////AQAAAEgGAADgAwAA/////wAAAAAAAAAAHAAAAAQAAAAAAAAAJAAAAGJjNTAzOGY3LTIzZTAtNDk2MC05NmRhLTMzYWJhZjU5MzVlYwAAAADw////bGYBANAJAABiYzUwiP///25rIABHQiuoR5zTAQAAAAAgAAAAAgAAAAAAAAAwDAAA/////wAAAAD/////4AMAAP////9IAAAAAAAAAAAAAAAAAAAABAAAACQAAAA3NTE2Yjk1Zi1mNzc2LTQ0NjQtOGM1My0wNjE2N2Y0MGNjOTkAAAAAiP///25rIABHQiuoR5zTAQAAAABYCgAAAAAAAAAAAAD//////////wEAAABwCwAA4AMAAP////8AAAAAAAAAABwAAAAEAAAAAAAAACQAAABhZGVkNWU4Mi1iOTA5LTQ2MTktOTk0OS1mNWQ3MWRhYzBiY2IAAAAA2P///3ZrDgAEAACARgAAAAQAAAABAAAARENTZXR0aW5nSW5kZXgAAPj///9ICwAA+P///zgNAAAIAAAAYWRlZIj///9uayAAR0IrqEec0wEAAAAAWAoAAAAAAAAAAAAA//////////8BAAAAKAwAAOADAAD/////AAAAAAAAAAAcAAAABAAAAAEAAAAkAAAAZjFmYmZkZTItYTk2MC00MTY1LTlmODgtNTA2Njc5MTFjZTk2L+4IP9j///92aw4ABAAAgBkAAAAEAAAAAQBRL0RDU2V0dGluZ0luZGV4qZ/4////AAwAAOj///9sZgIA0AoAAGFkZWSICwAAZjFmYoj///9uayAAU1Xlx0ec0wEAAAAAIAAAAAEAAAAAAAAAYA0AAP////8AAAAA/////+ADAAD/////SAAAAAAAAAAAAAAAAAAAAAUAAAAkAAAAOTU5NmZiMjYtOTg1MC00MWZkLWFjM2UtZjdjM2MwMGFmZDRiwTv4x4j///9uayAAU1Xlx0ec0wEAAAAASAwAAAAAAAAAAAAA//////////8BAAAAeAsAAOADAAD/////AAAAAAAAAAAcAAAABAAAAAAAAAAkAAAAMzRjN2I5OWYtOWE2ZC00YjNjLThkYzctYjY2OTNiNzhjZWY0hxCArdj///92aw4ABAAAgAIAAAADAAAAAQBj6kRDU2V0dGluZ0luZGV4ySnw////bGYBAMAMAAAzNGM3kAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA='
$PowerFile = 'C:\temp\HumanaPowerSettings.pow'
# Put code here to determine if item is compliant 
$PowerSetting = Get-CimInstance -ClassName WIN32_PowerPlan -Namespace root\cimv2\power
$ActiveSetting = ($PowerSetting | Where-Object {$_.IsActive}).ElementName
if($ActiveSetting -eq 'Humana Settings'){$compliant = $true}
else
{
    $compliant = $false
    #if the item is not compliant, be sure to run the lines below 
    if($remediate)
    {
        #Do we have the settings?
        if((Measure-Object -InputObject ($PowerSetting | Where-Object {$_.ElementName -eq 'Humana Settings'})).Count -ne 1)
        {
            # If it is not, put the code here to fix it 
            $ByteArray = [System.Convert]::FromBase64String($PowerText)
            [System.IO.File]::WriteAllBytes($PowerFile,$ByteArray)
            $cmd = 'C:\Windows\System32\powercfg.exe'
            $arg = "/IMPORT $PowerFile"
            $prm = $arg.Split(' ')
            & $cmd $prm
            Remove-Item -Path $PowerFile
            $PowerSetting = Get-CimInstance -ClassName WIN32_PowerPlan -Namespace root\cimv2\power
        }
        $HumanaPower = ($PowerSetting | Where-Object {$_.ElementName -eq 'Humana Settings'})
        $Guid = $HumanaPower.InstanceID -replace '.*{(.*)}.*','$1'
        $arg = "/SetActive $Guid"
        $prm = $arg.Split(' ')
        & $cmd $prm
        $compliant = $true
    }
} 
Write-Output $compliant