-- Software for a machine
select sys.netbios_name0, sft.publisher0, sft.productname0, sft.productversion0, sft.InstallSource0
from v_r_system_valid sys join
	 v_gs_installed_software sft on sys.resourceid = sft.resourceid
where sys.Netbios_Name0 = 'WKR90B5a1n' and
	  sft.ProductName0 not in (
		'1E NomadBranch x64',
		'1E Agent',
		'1E Shopping Agent',
		'1E BIOS to UEFI',
		'1E PXE Lite Local',
		'1E Nomad Branch Admin Extensions',
		'Adobe PDF iFilter 11 for 64-bit platforms',
		'Adobe Acrobat Reader DC (2015) MUI',
		'BeyondTrust Certificate Installer',
		'BeyondTrust PowerBroker Desktops Client for Windows',
		'Cisco WebEx Meeting Center',
		'Citrix Authentication Manager',
		'FireEye Endpoint Agent',
		'Hitachi ID Login Assistant',
		'Advanced Tiff Editor',
		'Workstation ID 7.0.6',
		'Fontsmith Humana SANS font 1',
		'Humana Outlook 2010 Secure Mail Add-In',
		'IBM Host On-Demand EHLLAPI Bridge 3.0.5',
		'Intel(R) Processor Graphics',
		'Lenovo UpdatesCatalogAgent',
		'McAfee Agent',
		'McAfee Endpoint Security Adaptive Threat Protection',
		'McAfee Endpoint Security Platform',
		'McAfee Endpoint Security Threat Prevention',
		'McAfee VirusScan Enterprise',
		'McAfee Data Exchange Layer',
		'Hitachi ID Password Manager Local Reset Extension',
		'Configuration Manager Client',
		'Local Administrator Password Solution',
		'Herramientas de corrección de Microsoft Office 2016: español',
		'Microsoft DCF MUI (English) 2016',
		'Microsoft Access Setup Metadata MUI (English) 2016',
		'Microsoft Access MUI (English) 2016',
		'Microsoft Excel MUI (English) 2016',
		'Microsoft Groove MUI (English) 2016',
		'Microsoft InfoPath 2013',
		'Microsoft InfoPath MUI (English) 2013',
		'Microsoft InfoPath MUI (English) 2016',
		'Microsoft Office 64-bit Components 2013',
		'Microsoft Office 64-bit Components 2016',
		'Microsoft Office Office 64-bit Components 2010',
		'Microsoft Office OSM MUI (English) 2013',
		'Microsoft Office OSM MUI (English) 2016',
		'Microsoft Office OSM UX MUI (English) 2016',
		'Microsoft Office Professional Plus 2016',
		'Microsoft Office Proof (English) 2010',
		'Microsoft Office Proof (French) 2010',
		'Microsoft Office Proof (Spanish) 2010',
		'Microsoft Office Proofing (English) 2010',
		'Microsoft Office Proofing (English) 2013',
		'Microsoft Office Proofing (English) 2016',
		'Microsoft Office Proofing Tools 2013 - English',
		'Microsoft Office Proofing Tools 2013 - Español',
		'Microsoft Office Proofing Tools 2016 - English',
		'Microsoft Office Shared 64-bit MUI (English) 2010',
		'Microsoft Office Shared 64-bit MUI (English) 2013',
		'Microsoft Office Shared 64-bit MUI (English) 2016',
		'Microsoft Office Shared 64-bit Setup Metadata MUI (English) 2010',
		'Microsoft Office Shared 64-bit Setup Metadata MUI (English) 2013',
		'Microsoft Office Shared 64-bit Setup Metadata MUI (English) 2016',
		'Microsoft Office Shared MUI (English) 2010',
		'Microsoft Office Shared MUI (English) 2013',
		'Microsoft Office Shared MUI (English) 2016',
		'Microsoft Office Shared Setup Metadata MUI (English) 2010',
		'Microsoft Office Shared Setup Metadata MUI (English) 2013',
		'Microsoft Office Shared Setup Metadata MUI (English) 2016',
		'Outils de vérification linguistique 2013 de Microsoft Office - Français',
		'Outils de vérification linguistique 2016 de Microsoft Office - Français',
		'Microsoft OneNote MUI (English) 2016',
		'Microsoft Outlook MUI (English) 2016',
		'Microsoft PowerPoint MUI (English) 2016',
		'Microsoft Publisher MUI (English) 2016',
		'Microsoft Policy Platform',
		'Microsoft Silverlight',
		'Microsoft Skype for Business 2016',
		'Microsoft Skype for Business MUI (English) 2016',
		'Microsoft Visio Viewer 2016',
		'Microsoft Visual C++ 2005 Redistributable',
		'Microsoft Visual C++ 2005 Redistributable (x64)',
		'Microsoft Visual C++ 2008 Redistributable - x64 9.0.30729.6161',
		'Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.17',
		'Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.4148',
		'Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.6161',
		'Microsoft Visual C++ 2010  x64 Redistributable - 10.0.40219',
		'Microsoft Visual C++ 2010  x86 Redistributable - 10.0.40219',
		'Microsoft Visual C++ 2012 Redistributable (x64) - 11.0.60610',
		'Microsoft Visual C++ 2012 Redistributable (x86) - 11.0.60610',
		'Microsoft Visual C++ 2012 x64 Additional Runtime - 11.0.60610',
		'Microsoft Visual C++ 2012 x64 Minimum Runtime - 11.0.60610',
		'Microsoft Visual C++ 2012 x86 Additional Runtime - 11.0.60610',
		'Microsoft Visual C++ 2012 x86 Minimum Runtime - 11.0.60610',
		'Microsoft Visual C++ 2013 Redistributable (x64) - 12.0.21005',
		'Microsoft Visual C++ 2013 Redistributable (x64) - 12.0.40660',
		'Microsoft Visual C++ 2013 Redistributable (x86) - 12.0.21005',
		'Microsoft Visual C++ 2013 Redistributable (x86) - 12.0.40660',
		'Microsoft Visual C++ 2013 x64 Additional Runtime - 12.0.40660',
		'Microsoft Visual C++ 2013 x64 Debug Runtime - 12.0.21005',
		'Microsoft Visual C++ 2013 x64 Minimum Runtime - 12.0.40660',
		'Microsoft Visual C++ 2013 x86 Additional Runtime - 12.0.40660',
		'Microsoft Visual C++ 2013 x86 Debug Runtime - 12.0.21005',
		'Microsoft Visual C++ 2013 x86 Minimum Runtime - 12.0.40660',
		'Microsoft Visual C++ 2015 x64 Debug Runtime - 14.0.23026',
		'Microsoft Visual C++ 2015 x86 Debug Runtime - 14.0.23026',
		'Microsoft Visual C++ 2017 Redistributable (x64) - 14.14.26429',
		'Microsoft Visual C++ 2017 Redistributable (x86) - 14.14.26429',
		'Microsoft Visual C++ 2017 x64 Additional Runtime - 14.14.26429',
		'Microsoft Visual C++ 2017 x64 Minimum Runtime - 14.14.26429',
		'Microsoft Visual C++ 2017 x86 Additional Runtime - 14.14.26429',
		'Microsoft Visual C++ 2017 x86 Minimum Runtime - 14.14.26429',
		'Microsoft Visual Studio 2010 Tools for Office Runtime (x64)',
		'Microsoft Word MUI (English) 2016',
		'MSXML 4.0 SP3 Parser',
		'OpenText Print2Fax',
		'Skype for Business 2016',
		'Java 8 Update 121',
		'Java 8 Update 121 (64-bit)',
		'Java Auto Updater',
		'UniversalForwarder',
		'TITUS Classification',
		'TITUS Classification (64 bit)',
		'ThinkRite Voice Desktop Client 4.0.15',
		'SecureDoc Disk Encryption (x64) 7.5',
		'Online Plug-in',
		'Citrix Web Helper',
		'Self-service Plug-in',
		'Google Update Helper',
		'Fontsmith Condensed FS Me or Humana Sans for PC 3') 
		and sft.ProductName0 not like 'Citrix Receiver%'
	    and sft.ProductName0 not like 'Flexera Software Corporate Software Inspector%'
	    and sft.ProductName0 not like 'Microsoft .NET Framework%'
		and sft.ProductName0 not like 'Vulkan Run Time Libraries%'
		and sft.ProductName0 not like 'Microsoft Visual C++ ____ Redistributable%'
		and sft.ProductName0 not like 'Microsoft Visual C++ ________ Additional Runtime%'
		and sft.ProductName0 not like 'Microsoft Visual C++ ________ Minimum Runtime%'
		and sft.ProductName0 not like 'Adobe Flash Player%'
		and sft.Publisher0 not like 'Lexmark%'
order by sft.Publisher0, sft.ProductName0, sft.ProductVersion0

-- Build for a machine
select osd.imagename0, SMSTSRole0, ImageInstalled0
from v_R_System_Valid sys join
	 v_GS_OSD640 osd on sys.ResourceID = osd.ResourceID
where sys.Netbios_Name0 = 'WKR90FBC7D'

-- List of Packages
select packageid, Manufacturer, Name, Version, Description, PkgSourcePath
from v_Package
where Name like '%CCP%'